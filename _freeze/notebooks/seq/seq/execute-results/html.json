{
  "hash": "273ef49b1d3e41905db76658c895785d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Seqeuncing\"\neditor_options: \n  chunk_output_type: console\n---\n\n# Volcano plots\n\nSetup\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Always load same package versions\ngroundhog.day <- \"2024-01-01\"\ngroundhog::meta.groundhog(groundhog.day) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[1;36mNow using 'groundhog_3.1.2'.\u001b[0m\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npkgs <-  c(\"data.table\",\n           \"readxl\",\n           \"ggplot2\",\n           \"ggrepel\",\n           \"here\")\n\ngroundhog.library(pkgs, groundhog.day)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at C:/Users/alosvendsen/Documents/R/manuscript\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'data.table_1.14.10'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'readxl_1.4.3'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'ggplot2_3.4.4'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'ggrepel_0.9.4'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'here_1.0.1'\u001b[0m\n```\n\n\n:::\n:::\n\n\n\n## Pooled IL-6 \nNo sig up or down regulated genes when pooling IL-6 10 and 0.1 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL6_vs_vehicle.xlsx\")\nil6_combined_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(il6_combined_data)\nil6_combined_data[logCPM > 1 & logFC > 1 & FDR < 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEmpty data.table (0 rows and 8 cols): matrixrow,ENSEMBL_ID,genes,logFC,logCPM,LR...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nil6_combined_data[logCPM > 1 & logFC < -1 & FDR < 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEmpty data.table (0 rows and 8 cols): matrixrow,ENSEMBL_ID,genes,logFC,logCPM,LR...\n```\n\n\n:::\n:::\n\nAs seen in empty dataframes there are no sig up or downregulated.\nAlso seen in the volcano plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Create a new column for labeling differential gene expression\nil6_combined_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil6_combined_data$diffexpressed[il6_combined_data$logFC > 1 & il6_combined_data$FDR < 0.05 & il6_combined_data$logCPM > 1] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil6_combined_data$diffexpressed[il6_combined_data$logFC < -1 & il6_combined_data$FDR < 0.05 & il6_combined_data$logCPM > 1] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil6_combined_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil6_combined_data$delabel[il6_combined_data$diffexpressed != \"NO\"] <- il6_combined_data$genes[il6_combined_data$diffexpressed != \"NO\"]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Create the volcano plot using ggplot2\nplot_volcano_il6_combined <- \n  ggplot(data=il6_combined_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 7) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(breaks = seq(-11, 9, 2)) + # Customize x-axis breaks\n    #scale_y_continuous(breaks = seq(0, 90, 10)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(), panel.grid.minor.x = element_blank())+ # Adjust minor grid lines\n    ggtitle('Volcano Plot: IL6 vs Vehicle') # Add a title to the plot\n\nplot_volcano_il6_combined\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 12820 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](seq_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## IL-6 10 ng/ml\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL6_10_vs_vehicle.xlsx\")\nil6_10_data <- read_xlsx(file, sheet = 1)\n```\n:::\n\n::: {#cell-fig-volcano-il6-10 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il6-10\n#| fig-cap: \"Volcano plot. IL-6 10 ng/ml vs. vehicle control\"\n\n# Create a new column for labeling differential gene expression\nil6_10_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil6_10_data$diffexpressed[il6_10_data$logFC > 1 & il6_10_data$FDR < 0.05 & il6_10_data$logCPM > 1] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil6_10_data$diffexpressed[il6_10_data$logFC < -1 & il6_10_data$FDR < 0.05 & il6_10_data$logCPM > 1] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil6_10_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil6_10_data$delabel[il6_10_data$diffexpressed != \"NO\"] <- il6_10_data$genes[il6_10_data$diffexpressed != \"NO\"]\n\n# Create the volcano plot using ggplot2\nplot_volcano_il6_10 <- \n  ggplot(data=il6_10_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 7) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(breaks = seq(-11, 9, 2)) + # Customize x-axis breaks\n    #scale_y_continuous(breaks = seq(0, 90, 10)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(), panel.grid.minor.x = element_blank())+ # Adjust minor grid lines\n    ggtitle('Volcano Plot: IL6 vs Vehicle') # Add a title to the plot\n\n\nplot_volcano_il6_10\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 11730 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 856 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Volcano plot. IL-6 10 ng/ml vs. vehicle control](seq_files/figure-html/fig-volcano-il6-10-1.png){#fig-volcano-il6-10 width=672}\n:::\n:::\n",
    "supporting": [
      "seq_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
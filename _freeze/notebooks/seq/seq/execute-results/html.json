{
  "hash": "d3d0c1e00549479d3f3acf6769a386f1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Seqeuncing\"\neditor_options: \n  chunk_output_type: console\n---\n\n# Volcano plots\n\nSetup\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Always load same package versions\ngroundhog.day <- \"2024-01-01\"\ngroundhog::meta.groundhog(groundhog.day) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[1;36mNow using 'groundhog_3.1.2'.\u001b[0m\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npkgs <-  c(\"data.table\",\n           \"readxl\",\n           \"ggplot2\",\n           \"ggrepel\",\n           \"here\")\n\ngroundhog.library(pkgs, groundhog.day)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at C:/Users/alosvendsen/Documents/R/manuscript\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'data.table_1.14.10'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'readxl_1.4.3'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'ggplot2_3.4.4'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'ggrepel_0.9.4'\u001b[0m\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\u001b[36mSuccessfully attached 'here_1.0.1'\u001b[0m\n```\n\n\n:::\n:::\n\n\n\n## IL-6 pooled\nNo sig up or down regulated genes when pooling IL-6 10 and 0.1 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL6_vs_vehicle.xlsx\")\nil6_combined_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(il6_combined_data)\nil6_combined_data[logCPM > 1 & logFC > 1 & FDR < 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEmpty data.table (0 rows and 8 cols): matrixrow,ENSEMBL_ID,genes,logFC,logCPM,LR...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nil6_combined_data[logCPM > 1 & logFC < -1 & FDR < 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEmpty data.table (0 rows and 8 cols): matrixrow,ENSEMBL_ID,genes,logFC,logCPM,LR...\n```\n\n\n:::\n:::\n\nAs seen in empty dataframes there are no sig up or downregulated.\nAlso seen in the volcano plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Create a new column for labeling differential gene expression\nil6_combined_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil6_combined_data$diffexpressed[il6_combined_data$logFC > 1 & il6_combined_data$FDR < 0.05 & il6_combined_data$logCPM > 1] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil6_combined_data$diffexpressed[il6_combined_data$logFC < -1 & il6_combined_data$FDR < 0.05 & il6_combined_data$logCPM > 1] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil6_combined_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil6_combined_data$delabel[il6_combined_data$diffexpressed != \"NO\"] <- il6_combined_data$genes[il6_combined_data$diffexpressed != \"NO\"]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Create the volcano plot using ggplot2\nplot_volcano_il6_combined <- \n  ggplot(data=il6_combined_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 7) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(breaks = seq(-11, 9, 2)) + # Customize x-axis breaks\n    #scale_y_continuous(breaks = seq(0, 90, 10)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(), panel.grid.minor.x = element_blank())+ # Adjust minor grid lines\n    ggtitle('Volcano Plot: IL6 vs Vehicle') # Add a title to the plot\n\nplot_volcano_il6_combined\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 12820 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](seq_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## IL-6 10 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL6_10_vs_vehicle.xlsx\")\nil6_10_data <- read_xlsx(file, sheet = 1)\n```\n:::\n\n::: {#cell-fig-volcano-il6-10 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il6-10\n#| fig-cap: \"Volcano plot. IL-6 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# Create a new column for labeling differential gene expression\nil6_10_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil6_10_data$diffexpressed[il6_10_data$logFC > 1 & il6_10_data$FDR < 0.05 & il6_10_data$logCPM > 1] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil6_10_data$diffexpressed[il6_10_data$logFC < -1 & il6_10_data$FDR < 0.05 & il6_10_data$logCPM > 1] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil6_10_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil6_10_data$delabel[il6_10_data$diffexpressed != \"NO\"] <- il6_10_data$genes[il6_10_data$diffexpressed != \"NO\"]\n\n# Create the volcano plot using ggplot2\nplot_volcano_il6_10 <- \n  ggplot(data=il6_10_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 10) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    scale_x_continuous(limits = c(-8, 10)) + # Customize x-axis breaks\n    scale_y_continuous(limits = c(0, 320)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(),# Remove minor grid lines\n          panel.grid.minor.x = element_blank(),# Remove minor grid lines\n          legend.position = \"bottom\" \n          )+ \n    ggtitle('Volcano Plot: IL6 10 ng/ml vs Vehicle') # Add a title to the plot\n\n\nplot_volcano_il6_10\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 11731 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing missing values (`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 838 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il6-10\n#| fig-cap: \"Volcano plot. IL-6 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# ggsave(filename = here(\"notebooks/seq/output/IL_6_10ng_volcano.png\"))\n```\n\n::: {.cell-output-display}\n![Volcano plot. IL-6 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds](seq_files/figure-html/fig-volcano-il6-10-1.png){#fig-volcano-il6-10 width=672}\n:::\n:::\n\n\nTrying to ad a box around the out of bounds data points. They have a smaller FDR than can be handled.\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# # Adjusting the dataset to include points with FDR of 0\n# il6_10_data$adjusted_FDR <- ifelse(il6_10_data$FDR == 0, 340, -log10(il6_10_data$FDR))\n# \n# # Create the volcano plot using ggplot2\n# plot_volcano_il6_10 <- \n#   ggplot(data=il6_10_data, aes(x=logFC, y=adjusted_FDR, col=diffexpressed, label=delabel)) + \n#     theme_minimal() +\n#     geom_text_repel(max.overlaps = 10) +\n#     scale_color_manual(values=c(\"blue\", \"black\", \"red\")) +\n#     geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") +\n#     geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Use the new adjusted value\n#     geom_point() +\n#     labs(color = 'Direction of gene expression',\n#          x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"),\n#          y = expression(\"-log\"[10]*\"Adjusted FDR\")) +\n#     scale_x_continuous(limits = c(-8, 10)) +\n#     scale_y_continuous(limits = c(0, 450)) +\n#     theme(\n#       panel.grid.minor.y = element_blank(),\n#       panel.grid.minor.x = element_blank(),\n#       legend.position = \"bottom\"\n#     ) +\n#     annotate(\"rect\", xmin = 1, xmax = 10, ymin = 320, ymax = 340, alpha = .2, color = \"black\") +\n#     ggtitle('Volcano Plot: IL6 10 ng/ml vs Vehicle')\n# \n# # Display the plot\n# plot_volcano_il6_10\n```\n:::\n\n\n## IL-6 0.1 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL6_0.1_vs_vehicle.xlsx\")\nil6_0.1_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(il6_0.1_data)\nil6_0.1_data[logCPM > 1 & FDR < 0.05 & logFC > 0] |> nrow()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 25\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nil6_0.1_data[logCPM > 1 & FDR < 0.05 & logFC < 0] |> nrow()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8\n```\n\n\n:::\n:::\n\nIkke nogen der er signifikant opreguleret når logFC > 1\nKun to signifikant nedregulerede ved logFC < -1\n\n\n::: {#cell-fig-volcano-il6-0.1 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il6-0.1\n#| fig-cap: \"Volcano plot. IL-6 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds. Note few significant above 2 fold change\"\n#| warning: false\n\n# Create a new column for labeling differential gene expression\nil6_0.1_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil6_0.1_data$diffexpressed[il6_0.1_data$FDR < 0.05 & il6_0.1_data$logCPM > 1 & il6_0.1_data$logFC > 0] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil6_0.1_data$diffexpressed[il6_0.1_data$FDR < 0.05 & il6_0.1_data$logCPM > 1 & il6_0.1_data$logFC < 0] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil6_0.1_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil6_0.1_data$delabel[il6_0.1_data$diffexpressed != \"NO\"] <- il6_0.1_data$genes[il6_0.1_data$diffexpressed != \"NO\"]\n\n# Create the volcano plot using ggplot2\nplot_volcano_il6_0.1 <- \n  ggplot(data=il6_0.1_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 10) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(limits = c(-8, 10)) + # Customize x-axis breaks\n    #scale_y_continuous(limits = c(0, 320)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(),# Remove minor grid lines\n          panel.grid.minor.x = element_blank(),# Remove minor grid lines\n          legend.position = \"bottom\" \n          )+ \n    ggtitle('Volcano Plot: IL6 0.1 ng/ml vs Vehicle') # Add a title to the plot\n\n\nplot_volcano_il6_0.1\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 12527 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 14 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il6-0.1\n#| fig-cap: \"Volcano plot. IL-6 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds. Note few significant above 2 fold change\"\n#| warning: false\n\n# ggsave(filename = here(\"notebooks/seq/output/IL_6_01ng_volcano.png\"))\n```\n\n::: {.cell-output-display}\n![Volcano plot. IL-6 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds. Note few significant above 2 fold change](seq_files/figure-html/fig-volcano-il6-0.1-1.png){#fig-volcano-il6-0.1 width=672}\n:::\n:::\n\n\n\n## IL-1B 10 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL1B_10_vs_vehicle.xlsx\")\nil1B_10_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(il1B_10_data)\nil1B_10_data[logCPM > 1 & FDR < 0.05 & logFC > 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     matrixrow      ENSEMBL_ID     genes     logFC   logCPM          LR\n  1:       291 ENSG00000140279     DUOX2 12.790794 8.347320 2277.172140\n  2:       405 ENSG00000124875     CXCL6 12.195921 8.005646 2972.542293\n  3:       791 ENSG00000148346      LCN2 12.009350 7.261156 3806.703723\n  4:       126 ENSG00000162896      PIGR  9.852750 9.434131 3827.211391\n  5:       827 ENSG00000163739     CXCL1  9.440479 7.213577 3272.572792\n ---                                                                   \n644:     10883 ENSG00000043462      LCP2  1.018781 1.283900   14.435759\n645:     10994 ENSG00000171159      BBLN  1.189024 1.180269   14.319229\n646:     10917 ENSG00000224177 LINC00570  1.034877 1.252402   12.987504\n647:     10507 ENSG00000121933    TMIGD3  1.034207 1.588031   10.083778\n648:     11052 ENSG00000197837     H4C16  1.162020 1.135079    9.665593\n           PValue          FDR\n  1: 0.0000000000 0.0000000000\n  2: 0.0000000000 0.0000000000\n  3: 0.0000000000 0.0000000000\n  4: 0.0000000000 0.0000000000\n  5: 0.0000000000 0.0000000000\n ---                          \n644: 0.0001450223 0.0005096406\n645: 0.0001542808 0.0005393741\n646: 0.0003135768 0.0010296025\n647: 0.0014958030 0.0042256107\n648: 0.0018775119 0.0051664753\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nil1B_10_data[logCPM > 1 & FDR < 0.05 & logFC < 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      matrixrow      ENSEMBL_ID    genes      logFC   logCPM          LR\n   1:      3300 ENSG00000244067    GSTA2 -4.5212283 5.772409 1364.247458\n   2:      3059 ENSG00000124713     GNMT -3.6845745 5.874258 1058.149424\n   3:      2357 ENSG00000157514  TSC22D3 -2.9498531 6.228880  908.447863\n   4:      1096 ENSG00000243955    GSTA1 -3.3906387 7.158369  834.560884\n   5:       253 ENSG00000134824    FADS2 -2.6050374 8.772206  662.623216\n  ---                                                                   \n5107:      3981 ENSG00000143337 TOR1AIP1 -0.2131858 5.326484    5.045137\n5108:     10007 ENSG00000166352    IFTAP  0.4827360 1.975639    5.041409\n5109:      4620 ENSG00000173011   TADA2B -0.2281305 5.007984    5.041217\n5110:      6371 ENSG00000105426    PTPRS -0.2735157 4.249032    5.040398\n5111:      3905 ENSG00000108773    KAT2A -0.2416985 5.353290    5.035219\n             PValue           FDR\n   1: 1.234821e-298 1.057666e-295\n   2: 4.121252e-232 2.117994e-229\n   3: 1.430100e-199 5.741850e-197\n   4: 1.652338e-183 6.433101e-181\n   5: 4.016527e-146 1.069140e-143\n  ---                            \n5107:  2.469516e-02  4.970756e-02\n5108:  2.474836e-02  4.980457e-02\n5109:  2.475110e-02  4.980457e-02\n5110:  2.476280e-02  4.982031e-02\n5111:  2.483695e-02  4.996166e-02\n```\n\n\n:::\n:::\n\n::: {#cell-fig-volcano-il1B-10 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il1B-10\n#| fig-cap: \"Volcano plot. IL-1B 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# Create a new column for labeling differential gene expression\nil1B_10_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil1B_10_data$diffexpressed[il1B_10_data$FDR < 0.05 & il1B_10_data$logCPM > 1 & il1B_10_data$logFC > 0] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil1B_10_data$diffexpressed[il1B_10_data$FDR < 0.05 & il1B_10_data$logCPM > 1 & il1B_10_data$logFC < 0] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil1B_10_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil1B_10_data$delabel[il1B_10_data$diffexpressed != \"NO\"] <- il1B_10_data$genes[il1B_10_data$diffexpressed != \"NO\"]\n\n# Create the volcano plot using ggplot2\nplot_volcano_il1B_0.1 <- \n  ggplot(data=il1B_10_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 10) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(limits = c(-8, 10)) + # Customize x-axis breaks\n    #scale_y_continuous(limits = c(0, 320)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(),# Remove minor grid lines\n          panel.grid.minor.x = element_blank(),# Remove minor grid lines\n          legend.position = \"bottom\" \n          )+ \n    ggtitle('Volcano Plot: IL1B 10 ng/ml vs Vehicle') # Add a title to the plot\n\n\nplot_volcano_il1B_0.1\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 7089 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 5707 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il1B-10\n#| fig-cap: \"Volcano plot. IL-1B 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# ggsave(filename = here(\"notebooks/seq/output/IL_1B_10ng_volcano.png\"))\n```\n\n::: {.cell-output-display}\n![Volcano plot. IL-1B 10 ng/ml vs. vehicle control. Vertical lines for fold change thresholds](seq_files/figure-html/fig-volcano-il1B-10-1.png){#fig-volcano-il1B-10 width=672}\n:::\n:::\n\n\n\n## IL-1B 0.1 ng/ml\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/IL1B_0.1_vs_vehicle.xlsx\")\nil1B_0.1_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(il1B_0.1_data)\nil1B_0.1_data[logCPM > 1 & FDR < 0.05 & logFC > 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     matrixrow     ENSEMBLE_ID   genes    logFC   logCPM          LR\n  1:      4397 ENSG00000162896    PIGR 5.504563 5.089152 1242.099261\n  2:      1306 ENSG00000144802  NFKBIZ 2.232729 6.815997  627.186283\n  3:       212 ENSG00000173432    SAA1 2.312561 8.923274  563.105943\n  4:      7108 ENSG00000093134   VNN3P 3.896135 3.862222  562.254109\n  5:       192 ENSG00000120738    EGR1 2.014840 9.029642  520.047519\n ---                                                                \n102:     11008 ENSG00000163121  NEURL3 1.082494 1.174285   12.704847\n103:     10703 ENSG00000118596 SLC16A7 1.092780 1.410331   12.522964\n104:     11102 ENSG00000188033  ZNF490 1.048070 1.112634   12.089886\n105:     10323 ENSG00000102109  PCSK1N 1.035666 1.719186   11.035213\n106:     10489 ENSG00000137449   CPEB2 1.371301 1.599855    9.592714\n            PValue           FDR\n  1: 4.325989e-272 5.490978e-268\n  2: 2.045414e-138 1.298122e-134\n  3: 1.774089e-124 7.506169e-121\n  4: 2.718167e-124 8.625424e-121\n  5: 4.132410e-115 1.049054e-111\n ---                            \n102:  3.647091e-04  8.478484e-03\n103:  4.019806e-04  9.146021e-03\n104:  5.069607e-04  1.101858e-02\n105:  8.939739e-04  1.716160e-02\n106:  1.953509e-03  3.279880e-02\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nil1B_0.1_data[logCPM > 1 & FDR < 0.05 & logFC < 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     matrixrow     ENSEMBLE_ID     genes      logFC   logCPM         LR\n  1:      1562 ENSG00000157514   TSC22D3 -1.2000653 6.563362 202.478982\n  2:      2865 ENSG00000119771    KLHL29 -1.0615745 5.774822 151.315095\n  3:       754 ENSG00000163660     CCNL1  0.9824179 7.469282 136.558149\n  4:      1961 ENSG00000244067     GSTA2 -0.9740021 6.298584 136.257727\n  5:      3802 ENSG00000162366  PDZK1IP1  0.9960760 5.340007 111.201074\n ---                                                                   \n680:      6476 ENSG00000105810      CDK6  0.3656351 4.141011   8.701521\n681:      4567 ENSG00000204262    COL5A2 -0.3048764 4.972220   8.683207\n682:       998 ENSG00000120889 TNFRSF10B  0.2367904 7.103988   8.633015\n683:      2562 ENSG00000165650     PDZD8  0.2484689 5.952045   8.630485\n684:      5492 ENSG00000129657   SEC14L1 -0.3435409 4.555601   8.621830\n           PValue          FDR\n  1: 6.010061e-46 2.934065e-43\n  2: 8.943743e-35 3.068187e-32\n  3: 1.506371e-31 4.663503e-29\n  4: 1.752424e-31 5.296077e-29\n  5: 5.346355e-26 1.357226e-23\n ---                          \n680: 3.179446e-03 4.775942e-02\n681: 3.211554e-03 4.818470e-02\n682: 3.301248e-03 4.947195e-02\n683: 3.305836e-03 4.948228e-02\n684: 3.321579e-03 4.965936e-02\n```\n\n\n:::\n:::\n\n::: {#cell-fig-volcano-il1B-0.1 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il1B-0.1\n#| fig-cap: \"Volcano plot. IL-1B 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# Create a new column for labeling differential gene expression\nil1B_0.1_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n\n# Identify and label upregulated genes\n# Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\nil1B_0.1_data$diffexpressed[il1B_0.1_data$FDR < 0.05 & il1B_0.1_data$logCPM > 1 & il1B_0.1_data$logFC > 0] <- \"UP\"\n\n# Identify and label downregulated genes\n# Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\nil1B_0.1_data$diffexpressed[il1B_0.1_data$FDR < 0.05 & il1B_0.1_data$logCPM > 1 & il1B_0.1_data$logFC < 0] <- \"DOWN\"\n\n# Initialize 'delabel' column to NA for all rows to create the column\nil1B_0.1_data$delabel <- NA\n\n# Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\nil1B_0.1_data$delabel[il1B_0.1_data$diffexpressed != \"NO\"] <- il1B_0.1_data$genes[il1B_0.1_data$diffexpressed != \"NO\"]\n\n# Create the volcano plot using ggplot2\nplot_volcano_il1B_0.1 <- \n  ggplot(data=il1B_0.1_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n    theme_minimal() + # Use a minimal theme for the plot\n    geom_text_repel(max.overlaps = 7) + # Use repelling text to avoid label overlap\n    scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n    geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") + # Vertical lines for fold change thresholds\n    geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Horizontal line for FDR threshold\n    geom_point() + # Add points for each gene\n    labs(color = 'Direction of gene expression', # Customize legend title\n         x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n         y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n    #scale_x_continuous(limits = c(-8, 10)) + # Customize x-axis breaks\n    #scale_y_continuous(limits = c(0, 320)) + # Customize y-axis breaks\n    theme(panel.grid.minor.y = element_blank(),# Remove minor grid lines\n          panel.grid.minor.x = element_blank(),# Remove minor grid lines\n          legend.position = \"bottom\" \n          )+ \n    ggtitle('Volcano Plot: IL1B 0.1 ng/ml vs Vehicle') # Add a title to the plot\n\n\nplot_volcano_il1B_0.1\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 11903 rows containing missing values (`geom_text_repel()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 771 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-volcano-il1B-0.1\n#| fig-cap: \"Volcano plot. IL-1B 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds\"\n#| warning: false\n\n# ggsave(filename = here(\"notebooks/seq/output/IL_1B_01ng_volcano.png\"))\n```\n\n::: {.cell-output-display}\n![Volcano plot. IL-1B 0.1 ng/ml vs. vehicle control. Vertical lines for fold change thresholds](seq_files/figure-html/fig-volcano-il1B-0.1-1.png){#fig-volcano-il1B-0.1 width=672}\n:::\n:::\n\n\n## Abemaciclib 5 µM \n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Import raw data from the specified Excel file and sheet\nfile <- here(\"notebooks/seq/data_raw/abe_vs_vehicle.xlsx\")\nabe_data <- read_xlsx(file, sheet = 1)\n\n\nsetDT(abe_data)\nabe_data[logCPM > 1 & FDR < 0.05 & logFC > 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     matrixrow      ENSEMBL_ID           genes    logFC   logCPM         LR\n  1:      1656 ENSG00000140470        ADAMTS17 2.736348 6.631470 569.837805\n  2:      4904 ENSG00000161896           IP6K3 2.729978 4.906166 441.472543\n  3:      5856 ENSG00000157557            ETS2 2.826833 4.472978 371.842471\n  4:      6006 ENSG00000169258          GPRIN1 3.182320 4.438138 368.052632\n  5:      1033 ENSG00000156510           HKDC1 2.291036 7.161496 338.469713\n ---                                                                       \n543:     11113 ENSG00000069812            HES2 1.055350 1.028193  11.189460\n544:     10925 ENSG00000266313 ENSG00000266313 1.019175 1.183450  10.890585\n545:     10956 ENSG00000232679       LINC01705 1.006567 1.166972   9.967888\n546:     11004 ENSG00000120334           CENPL 1.104778 1.134940   8.230452\n547:     10463 ENSG00000163399          ATP1A1 1.028020 1.509585   7.652900\n            PValue           FDR\n  1: 6.089737e-126 9.712369e-123\n  2:  5.175655e-98  3.001645e-95\n  3:  7.430768e-83  3.160306e-80\n  4:  4.968204e-82  2.044817e-79\n  5:  1.374492e-75  4.496703e-73\n ---                            \n543:  8.226327e-04  2.103401e-03\n544:  9.665429e-04  2.435734e-03\n545:  1.592941e-03  3.839690e-03\n546:  4.119326e-03  9.029059e-03\n547:  5.668112e-03  1.203318e-02\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nabe_data[logCPM > 1 & FDR < 0.05 & logFC < 1] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      matrixrow      ENSEMBL_ID     genes      logFC    logCPM          LR\n   1:       193 ENSG00000124253      PCK1 -7.3910348  8.918734 2613.265382\n   2:       278 ENSG00000138115    CYP2C8 -4.0321531  8.470964 1187.675046\n   3:        82 ENSG00000197408    CYP2B6 -2.8311130 10.051964  729.734930\n   4:       120 ENSG00000134240    HMGCS2 -2.8577733  9.588448  708.417598\n   5:      2647 ENSG00000157087    ATP2B2 -3.1479931  5.947785  687.874644\n  ---                                                                     \n5912:       162 ENSG00000108654      DDX5  0.2229198  9.205413    4.839048\n5913:      3249 ENSG00000186815     TPCN1 -0.2558597  5.666161    4.837830\n5914:      7447 ENSG00000151320     AKAP6 -0.3351600  3.669124    4.833075\n5915:     10108 ENSG00000137970    RPL7P9  0.5536888  1.801992    4.827948\n5916:     11100 ENSG00000226696 LENG8-AS1 -0.6814634  1.042936    4.823560\n             PValue           FDR\n   1:  0.000000e+00  0.000000e+00\n   2: 2.909826e-260 1.856323e-256\n   3: 1.022911e-160 4.350439e-157\n   4: 4.418324e-156 1.409335e-152\n   5: 1.295613e-151 3.306146e-148\n  ---                            \n5912:  2.782225e-02  4.957186e-02\n5913:  2.784191e-02  4.959996e-02\n5914:  2.791880e-02  4.972999e-02\n5915:  2.800193e-02  4.986415e-02\n5916:  2.807330e-02  4.998427e-02\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# #| label: fig-abemaceclib\n# #| fig-cap: \"Volcano plot. Abemaciclib vs. vehicle control. Vertical lines for fold change thresholds\"\n# #| warning: false\n# \n# # Create a new column for labeling differential gene expression\n# abe_data$diffexpressed <- \"NO\" # Default value for genes not differentially expressed\n# \n# # Identify and label upregulated genes\n# # Genes with log2FoldChange > 1, FDR < 0.05, and logCPM > 1 are labeled as \"UP\"\n# abe_data$diffexpressed[abe_data$FDR < 0.05 & abe_data$logCPM > 1 & abe_data$logFC > 0] <- \"UP\"\n# \n# # Identify and label downregulated genes\n# # Genes with log2FoldChange < -1, FDR < 0.05, and logCPM > 1 are labeled as \"DOWN\"\n# abe_data$diffexpressed[abe_data$FDR < 0.05 & abe_data$logCPM > 1 & abe_data$logFC < 0] <- \"DOWN\"\n# \n# # Initialize 'delabel' column to NA for all rows to create the column\n# abe_data$delabel <- NA\n# \n# # Now, you can safely assign gene names to the 'delabel' column for differentially expressed genes\n# abe_data$delabel[abe_data$diffexpressed != \"NO\"] <- abe_data$genes[abe_data$diffexpressed != \"NO\"]\n# \n# # Create the volcano plot using ggplot2\n# plot_volcano_abe <- \n#   ggplot(data=abe_data, aes(x=logFC, y=-log10(FDR), col=diffexpressed, label=delabel)) + \n#     theme_minimal() + # Use a minimal theme for the plot\n#     geom_text_repel() + # Use repelling text to avoid label overlap\n#     scale_color_manual(values=c(\"blue\", \"black\", \"red\")) + # Custom colors for differential expression\n#     geom_vline(xintercept=c(-1, 1), col=\"dark grey\", linetype = \"dashed\") + # Vertical lines for fold change thresholds\n#     geom_hline(yintercept=-log10(0.05), col=\"dark grey\", linetype = \"dashed\") + # Horizontal line for FDR threshold\n#     geom_point() + # Add points for each gene\n#     labs(color = 'Direction of gene expression', # Customize legend title\n#          x = expression(\"log\"[2]*\"FC (IL6 vs Vehicle)\"), # Customize x-axis label\n#          y = expression(\"-log\"[10]*\"FDR\")) + # Customize y-axis label\n#     #scale_x_continuous(limits = c(-8, 10)) + # Customize x-axis breaks\n#     #scale_y_continuous(limits = c(0, 320)) + # Customize y-axis breaks\n#     theme(panel.grid.minor.y = element_blank(),# Remove minor grid lines\n#           panel.grid.minor.x = element_blank(),# Remove minor grid lines\n#           legend.position = \"bottom\",\n#           panel.background = element_rect(fill = \"white\")\n#           )+ \n#   coord_flip() +\n#     ggtitle('Volcano Plot: 5 µM abemaciclib vs Vehicle') # Add a title to the plot \n# \n# \n# \n# plot_volcano_abe\n# \n# ggsave(filename = here(\"notebooks/seq/output/abe_volcano.png\"))\n```\n:::\n",
    "supporting": [
      "seq_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
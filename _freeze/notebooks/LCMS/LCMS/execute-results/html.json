{
  "hash": "0c302caa74c45e71fa1f913dde6e63bd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: LCMS\n---\n\n\n# LCMS\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(readxl)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at C:/Users/alosvendsen/Documents/R/manuscript\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(RColorBrewer)\n```\n:::\n\n\n\n## Donor 3, AS0013B, Midazolam\nCheck peak status' for any amounts below what below/above the limit of our standard curve.\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndonor_3_data <- \n  readRDS(here(\"notebooks/LCMS/data_processed/AS0013.rds\"))\n\n# Check peak status'\nunique(donor_3_data$peak_status)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA             \"Response Low\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Find any that is not NA\ndonor_3_data[!is.na(peak_status)] |> knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|sample_name |    amount|peak_status  |metabolite       | donor|treatment     |time_treatment | time_incubation| rep| mean_amount| control_mean| relative_amount| mean_relative_amount|\n|:-----------|---------:|:------------|:----------------|-----:|:-------------|:--------------|---------------:|---:|-----------:|------------:|---------------:|--------------------:|\n|AS0008_135  | 0.9118640|Response Low |Hydroxymidazolam |     2|10 ng/ml IL-6 |72             |             0.5|   3|    1.530223|     7.625022|       0.1195884|            0.2006845|\n|AS0008_197  | 0.8381536|Response Low |Hydroxymidazolam |     2|10 ng/ml IL-6 |120            |             0.5|   1|    3.593515|    13.685163|       0.0612454|            0.2625847|\n\n\n:::\n:::\n\n#### Should this be omitted? It is below the lowest point on our standard curve, but omitting it would make the mean higher, than it really is?\n\n\n### **Plots**\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Create groups/look up tables for subsetting data\ngroup_IL6 <- c(#\"control\", \n               #\"medium\", \n               \"0.01 ng/ml IL-6\", \n               \"0.1 ng/ml IL-6\",\n               \"1 ng/ml IL-6\", \n               \"10 ng/ml IL-6\"\n               )\n\ngroup_IL1B <- c(#\"control\", \n                #\"medium\", \n                \"0.01 ng/ml IL-1B\", \n                \"0.1 ng/ml IL-1B\",\n                \"1 ng/ml IL-1B\",\n                \"10 ng/ml IL-1B\"\n                )\n```\n:::\n\n\nIL-6 effect on CYP3A4\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_data <- \n  donor_3_data[time_incubation == 0.5 \n               & treatment %in% group_IL6\n               ]\n\n\nact_3A4_IL_6_AS0013 <- \n  ggplot(data = plot_data) +\n  geom_point(aes(x = treatment,\n                 y = mean_relative_amount,\n                 color = factor(time_treatment)\n                 ),\n             size = 8,\n             alpha = 0.7,\n             ) +\n  scale_color_brewer(palette = \"Set2\") +\n  geom_point(aes(x = treatment,\n                 y = relative_amount\n                 ),\n             size = 4,\n             alpha = 0.3\n             ) +\n  geom_hline(yintercept = 1) +\n  scale_y_continuous(\n    name = \"OH-midazolam formation relative to vehicle control\", \n    breaks = seq(from = 0, to = 1.5, by= 0.25)\n    ) +\n  facet_wrap(\n    facets = vars(factor(time_treatment))\n    ) +\n  theme_bw() +\n  xlab(\"Treatment\") + \n  ggtitle(\"CYP3A4 activity after treatment with IL-6\",\n          subtitle = \"Facetted on treatment duration in hours\"\n          ) +\n  ylab(\"Metabolite formation relative to vehicle control\") +\n  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1),\n        axis.title.x = element_text(hjust = 0.5, vjust = 0, face = \"bold\"),\n        axis.title.y = element_text(face = \"bold\"),\n        legend.position = \"none\"\n        )\n\n\nact_3A4_IL_6_AS0013\n```\n\n::: {.cell-output-display}\n![](LCMS_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nggsave(\n  plot = last_plot(),\n  filename = \"3A4_IL_6_AS0013.png\",\n  device = \"png\",\n  path = here(\"notebooks/LCMS/output\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSaving 7 x 5 in image\n```\n\n\n:::\n:::\n",
    "supporting": [
      "LCMS_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}